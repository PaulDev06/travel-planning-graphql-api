export const __webpack_id__=8983;export const __webpack_ids__=[8982,8983];export const __webpack_modules__={8982:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mermaidEscape=t.COLORS=void 0,t.planToMermaid=function(e,{concise:s=!1,skipBuckets:l=n.g.grafastExplainMermaidSkipBuckets??!1}={}){if("v1"!==e.version)throw new Error("planToMermaid only supports v1 plan JSON");const a=Object.create(null),d=Object.create(null),f=Object.create(null),u=[];e.buckets.forEach(e=>{if(d[e.id])throw new Error(`Two buckets with the same ID ${e.id}?`);d[e.id]=e;const t=[...e.steps].sort((e,t)=>t.dependencyIds.length-e.dependencyIds.length);for(const e of t){if(a[e.id])throw new Error(`Step ${e.id} (${e.stepClass}/${e.metaString}) duplicated in plan?!`);a[e.id]=e,u.push(e);for(const t of e.dependencyIds)f[t]?f[t].push(e):f[t]=[e]}});const $=e=>"ConstantStep"===e.stepClass||"undefined"===e.extra?.constant?.type||!(0!==e.bucketId||!e.isSyncAndSafe||0!==(f[e.id]?.length??0)),h=e=>"polymorphicPartition"===d[e].reason.type?I.find(t=>t.childIds.includes(e)):e,m=e=>{const t=a[e];if(!t)return!0;if("ConstantStep"===t.stepClass)return!0;if(0!==t.bucketId)return!1;const n=f[e];if(!n||0===n.length)return!1;const s=n[0];return n.some(e=>h(e.bucketId)!==h(s.bucketId))},S=e=>t.COLORS[e%t.COLORS.length],b=["%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%",(s?"flowchart":"graph")+" TD","    classDef path fill:#eee,stroke:#000,color:#000","    classDef plan fill:#fff,stroke-width:1px,color:#000","    classDef itemplan fill:#fff,stroke-width:2px,color:#000","    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000","    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000","    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left",""],g=e=>`${e.stepClass.replace(/Step$/,"")}${0===e.bucketId?"":`{${e.bucketId}}`}${e.metaString?`<${e.metaString}>`:""}[${e.id}]`,I=Object.values(d);if(!l){s||b.push("    subgraph Buckets");for(let e=0,n=I.length;e<n;e++){const n=I[e],s=` (${n.reason.type})`+("polymorphicPartition"===n.reason.type?`\n|${n.reason.typeNames.join("\n|")}`:"polymorphic"===n.reason.type?`\n__typename: ${o(a[n.reason.parentStepId])}`:"");b.push(`    Bucket${n.id}(${(0,t.mermaidEscape)(`Bucket ${n.id}${s}${null!=n.parentSideEffectStepId?`\nParent side effect step: ${a[n.parentSideEffectStepId].id}`:""}${n.copyStepIds.length>0?`\nDeps: ${n.copyStepIds.map(e=>a[e].id).join(", ")}`:""}${"polymorphicPartition"===n.reason.type?"\n"+r(n.reason.polymorphicPaths):""}\n${null!=n.rootStepId&&"root"!==n.reason.type?`\nROOT ${g(a[n.rootStepId])}`:""}${x(n)}`)}):::bucket`)}s||b.push("    end")}if(!l)for(let e=0,t=I.length;e<t;e++){const t=I[e],n=t.childIds.map(e=>`Bucket${e}`);n.length>0&&b.push(`    Bucket${t.id} --\x3e ${n.join(" & ")}`)}const y=Object.create(null),_=e=>{if(!y[e.id]){$(e)&&console.warn(`Was expecting to hide step ${e.id}, but we're rendering it anyway?`);const n=e.stepClass.replace(/Step$/,""),c=`${n}${e.id}`;y[e.id]=c;const p=e.metaString,l=null!=p?(0,i.stripAnsi)(p):null,d=s&&l?((e,t=8,n=8)=>e.length>t+n+4?`${e.slice(0,t)}...${e.slice(e.length-n)}`:e)(l):l,u=e.supportsUnbatched,h=r(e.polymorphicPaths),S=e.dependencyIds.filter(t=>a[t].bucketId===e.bucketId),g=S.length>=1&&S.every(e=>r(a[e].polymorphicPaths)===h),I=g||""===h?"":`\n${h}`,[_,k,j="",O=n]="__ItemStep"===e.stepClass?["[/","\\]"]:"__ValueStep"===e.stepClass&&e.extra?.combined?[null,null,"docs","__Combined"]:e.isSyncAndSafe?u?["{{","}}"]:["[","]"]:["[[","]]"],E=m(e.id)?`\nDependents: ${f[e.id]?.length}`:"",x=e.dependencyIds.filter(m),w=x.length>0?`\nMore deps:\n${x.map(e=>`- ${o(a[e])}`).join("\n")}`:"",C=`${O}[${e.id}∈${e.bucketId}${e.stream?"@s":""}]${e.isUnary?" ➊":""}${g&&""!==h?"^":""}${d?`\n<${d}>`:""}${I}${E}${w}`,v=e.hasSideEffects?"sideeffectplan":"__ItemStep"===e.stepClass?"itemplan":u&&!e.isSyncAndSafe?"unbatchedplan":"plan";null===_?b.push(`    ${c}:::${v}@{shape: ${j}, label: ${(0,t.mermaidEscape)(C)}}`):b.push(`    ${c}${_}${(0,t.mermaidEscape)(C)}${k}:::${v}`)}return y[e.id]};b.push(""),b.push("    %% plan dependencies");const k=Object.create(null),j=(e,n)=>{const s=e.dependencyForbiddenFlags[n],o=e.dependencyOnReject[n],c=[];s&&(2&~s||c.push("rejectNull"),1&s||c.push("trapError"),4&s||c.push("trapInhibited"),o&&c.push(`onReject=${function(e,t=15){return e.length>t?e.substring(0,t-2)+"…":e}((0,i.stripAnsi)(o))}`));const r=c.join(";");return r?`|${(0,t.mermaidEscape)(r)}|`:""};u.forEach(e=>{if($(e))return;const t=_(e),n=e.dependencyIds.map(e=>{const t=a[e];return $(t)||m(e)?null:_(t)}),i=n.find(e=>null!=e);if(n.length>0&&i)if("__ItemStep"===e.stepClass){const s=null==e.extra?.transformStepId?"==>":"-.->";b.push(`    ${i} ${s}${j(e,0)} ${t}`);const o=[];for(let s=0;s<n.length;s++){const c=n[s];if(null==c||c===i)continue;const r=j(e,s);r?b.push(`    ${c} --\x3e${r} ${t}`):o.push(c)}o.length>0&&p(b,t,o)}else if(s&&!f[e.id]&&1===n.length)void 0===k[i]?b.push(`    ${i} --\x3e${j(e,0)} ${t}`):b.push(`    ${k[i]} o--o${j(e,0)} ${t}`),k[i]=t;else{const s=[];for(let i=0;i<n.length;i++){const o=n[i];if(null==o)continue;const c=j(e,i);c?b.push(`    ${o} --\x3e${c} ${t}`):s.push(o)}p(b,t,s)}return e}),b.push(""),b.push("    %% define steps"),u.forEach(e=>{$(e)||_(e)});for(let e=0,t=I.length;e<t;e++){const t=I[e],n=t.steps;b.push(`    classDef bucket${t.id} stroke:${S("number"==typeof t.id?t.id:Object.values(d).indexOf(t))}`),b.push(`    class ${[`Bucket${t.id}`,...n.filter(e=>!$(e)).map(_)].join(",")} bucket${t.id}`)}let O=!0;const E=(e,t)=>a[e].dependencyIds.some(e=>e===t||a[e].implicitSideEffectStepId===t||E(e,t));u.forEach(e=>{if(e.implicitSideEffectStepId&&!E(e.id,e.implicitSideEffectStepId)){O&&(b.push(""),b.push("    %% implicit side effects"),O=!1);const t=a[e.implicitSideEffectStepId];b.push(`    ${_(t)} -.-o ${_(e)}`)}}),b.push("");for(let e=0,t=I.length;e<t;e++){const t=I[e];if("combined"===t.reason.type)for(const{targetStepId:e,sources:n}of t.reason.combinations){const t=a[e];for(const{stepId:e}of n){const n=a[e];b.push(`    ${_(n)} -.-x ${_(t)}`)}}}return b.join("\n");function x(e){return 1===e.phases.length?"":`\n${e.phases.map((e,t)=>`${t+1}: ${c(e.normalStepIds?.map(e=>a[e]))}${e.unbatchedStepIds?`\n>: ${c(e.unbatchedStepIds.map(e=>a[e]))}`:""}`).join("\n")}`}};const s=n(85608),i=n(76856);function o(e){return"ConstantStep"===e.stepClass?`Constant${e.metaString?`<${e.metaString}>`:""}[${e.id}]`:`${e.stepClass.replace(/Step$/,"")??""}[${e.id}]`}function c(e){if(!e)return"";const t=e.map(o).join(", ");return t.length<40?t:e.map(e=>e.id).join(", ")}function r(e){if(null==e)return"";const t=Object.create(null),n=[],s=Object.create(null);for(const i of e){const e=i.lastIndexOf(">");if(e<=0)n.push(i);else{const n=i.slice(e);s[n]=i,t[n]?t[n]++:t[n]=1}}for(const[e,i]of Object.entries(t))n.push(1===i?s[e]:`(${i}) ...${e}`);return n.join("\n")}function p(e,t,n){if(n.length){const s=Object.create(null);for(const e of n)s[e]?s[e]++:s[e]=1;const i=Object.keys(s).filter(e=>1===s[e]);i.length>=1&&e.push(`    ${i.join(" & ")} --\x3e ${t}`);for(const[n,i]of Object.entries(s))1!==i&&e.push(`    ${n} -- ${i} --\x3e ${t}`)}}t.COLORS=["#696969","#00bfff","#7f007f","#ffa500","#0000ff","#7fff00","#ff1493","#808000","#dda0dd","#ff0000","#ffff00","#00ffff","#4169e1","#3cb371","#a52a2a","#ff00ff","#f5deb3"],t.mermaidEscape=e=>e.match(/^[a-z0-9 ]+$/i)?e:`"${(0,i.stripAnsi)(e.trim()).replace(/[#"<>]/g,e=>({"#":"ꖛ",'"':"”","<":"ᐸ",">":"ᐳ"}[e])).replace(/\r?\n/g,"<br />")}"`,s.__exportStar(n(43548),t)},43548:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},76856:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ANSI_REGEXP=void 0,t.stripAnsi=function(e){return e.replace(t.ANSI_REGEXP,"")},t.ANSI_REGEXP=/[\u001B\u009B][[\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\d\/#&.:=?%@~_]+)*|[a-zA-Z\d]+(?:;[-a-zA-Z\d\/#&.:=?%@~_]*)*)?\u0007)|(?:(?:\d{1,4}(?:;\d{0,4})*)?[\dA-PR-TZcf-nq-uy=><~]))/g},78983:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var s=n(31085),i=n(8982),o=n(67367),c=n(14041);let r=!1;const p=({plan:e})=>{const t=(0,c.useMemo)(()=>(0,i.planToMermaid)(e),[e]);return(0,c.useEffect)(()=>{r||(r=!0,o.default.initialize({startOnLoad:!0,maxTextSize:1e6,maxEdges:1e3})),t&&o.default.contentLoaded()},[t]),(0,s.jsx)("div",{className:"mermaid",children:t},t)}}};
//# sourceMappingURL=8983.js.map